# Настройка
1. Создаём новую БД для проекта: `utf8mb4` и `utf8mb4_0900_ai_ci`
  ```sql
CREATE DATABASE lemurro CHARACTER SET utf8mb4;
  ```
3. Импортируем в БД файл `/database.sql`
4. Добавляем первого *живого* пользователя с правами администратора:
  ```sql
INSERT INTO `users`
SET `id`         = 2,
    `auth_id`    = 'admin@email.tld',
    `created_at` = '2018-04-24 00:00:00';

INSERT INTO `info_users`
SET `id`          = 2,
    `user_id`     = 2,
    `roles`       = '{"admin":true}',
    `email`       = 'admin@email.tld',
    `first_name`  = 'Иван',
    `second_name` = 'Иванович',
    `last_name`   = 'Иванов',
    `created_at`  = '2018-04-24 00:00:00';
  ```
  \* Обратите внимание, пользователь идёт под номером 2, т.к. в системе уже есть один пользователь с правами администратора (используемый для cli-скриптов)
4. Определяем параметры проекта: `/app/Configs`, для файлов с суффиксом `.example` создаём копии и убираем суффикс (сами файлы `.example` при этом оставляем в неизменном виде и только их храним в системе версий), у вас должны получится вот такие файлы:
  - `/app/Configs/SettingsAuth.php`
  - `/app/Configs/SettingsCron.php`
  - `/app/Configs/SettingsDatabase.php`
  - `/app/Configs/SettingsFile.php`
  - `/app/Configs/SettingsGeneral.php`
    - `const PRODUCTION` - если установлена в `false` тогда не отправляются письма если не настроен `SMTP` и код для входа отображается в консоли браузера
  - `/app/Configs/SettingsMail.php`
  - `/app/Configs/SettingsMaintenance.php`
  - `/app/Configs/SettingsPath.php`
  - `/app/Configs/SettingsSMS.php`
5. Настраиваем файл `/app/Configs/EmailTemplates.php`
  - Для преобразования вашего логотипа в формат base64 можно воспользоваться онлайн-сервисом [BASE64 Image](https://www.base64-image.de)
6. Cron-задачи: вам необходимо добавить всего лишь одну задачу в `crontab`
  ```bash
  * * * * * /path/to/php /path/to/lemurro-cron.php > /dev/null
  ```
  Каждую минуту будет выполняться файл `lemurro-cron.php`, в нём используется библиотека [Jobby](https://github.com/jobbyphp/jobby), которая определяет какую задачу необходимо выполнить, подробнее прочитать можно [здесь](../40_Использование/60_Cron-задачи.md)
7. Для Nginx поместите в директиву `server` код, указанный ниже:
  ```nginx
  error_page 405 =200 $uri;

  location / {
      if ($request_method = OPTIONS) {
          add_header "Access-Control-Allow-Methods"      "GET,POST,OPTIONS";
          add_header "Access-Control-Allow-Origin"       "*";
          add_header "Access-Control-Allow-Credentials"  "true";
          add_header "Access-Control-Allow-Headers"      "X-SESSION-ID,X-UTC-OFFSET,X-Requested-With,X-File-Name";
          add_header "Access-Control-Expose-Headers"     "Content-disposition";
          add_header "Content-Length"                    0;
          add_header "Content-Type"                      "text/plain";

          return 204;
      }

      try_files $uri /index.php$is_args$args;
  }

  location ~ ^/index\.php(/|$) {
      include fastcgi.conf;

      fastcgi_pass 127.0.0.1:9080;
      fastcgi_split_path_info ^(.+\.php)(/.*)$;
      fastcgi_index index.php;

      # Optionally set the value of the environment variables used in the application
      # fastcgi_param APP_ENV prod;
      # fastcgi_param APP_SECRET <app-secret-id>;
      # fastcgi_param DATABASE_URL "mysql://db_user:db_pass@host:3306/db_name";

      # When you are using symlinks to link the document root to the
      # current version of your application, you should pass the real
      # application path instead of the path to the symlink to PHP FPM.
      #
      # Otherwise, PHP's OPcache may not properly detect changes to
      # your PHP files (see https://github.com/zendtech/ZendOptimizerPlus/issues/126
      # for more information).
      #
      # Caveat: When PHP-FPM is hosted on a different machine from nginx
      #         $realpath_root may not resolve as you expect! In this case try using
      #         $document_root instead.
      fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;
      fastcgi_param DOCUMENT_ROOT $realpath_root;

      # Prevents URIs that include the front controller. This will 404:
      # http://domain.tld/index.php/some-path
      # Remove the internal directive to allow URIs like this
      internal;
  }

  # Return 404 for all other php files not matching the front controller
  # this prevents access to other php files you don't want to be accessible.
  location ~ \.php$ {
      return 404;
  }
  ```
8. Переходим в браузере по адресу `https://ваш-путь-до-api` вы должны увидеть json-ответ: `{"data":{"version":{"android":1,"ios":1}}}` это значит всё настроено правильно
