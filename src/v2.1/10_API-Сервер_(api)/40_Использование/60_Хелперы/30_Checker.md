# Checker - модуль проверок

> Для проверки прав на элементах страницы смотрите [здесь](../../../20_Клиент_Metronic_(web)/20_Использование/40_Проверка_прав_на_элементах_страницы.md)
>
> Для добавления нового права доступа смотрите [здесь](../80_Добавление_права_доступа.md)

Для проверок в системе создан специальный чекер, расположенный в ядре `/src/Checker/Checker.php`

Существует встроенная проверка актуальности сессии.

Также вы можете создавать собственные проверки.

## Проверка актуальности сессии
В месте вашего кода (обычно это в начале запуска контроллера) разместить следующий код:
```php
$this->checker->run([
    'auth' => '',
]);

// Проверка успешно пройдена, в ином случае сработает исключение и будет автоматически выброшена соотвествующая ошибка в ответе сервера
```
Или мы можем сами отловить исключение
```php
try {
    $this->checker->run([
        'role' => [
            'page' => 'example',
            'access' => 'my-access',
        ],
    ]);

    // Проверка успешно пройдена
} catch (ResponseException $e) {
    LogException::write($this->log, $e);

    // Проверка провалилась
}
```

Также есть возможность напрямую проверить актуальность сессии:
```php
use Lemurro\Api\Core\Session;

$result_session_check = (new Session($this->dic['config']['auth']))->check($this->dic['session_id']);
if (isset($result_session_check['errors'])) {
    // Сессия устарела
    $this->response->setData($checker_result);
    return $this->response;
}

// Проверка успешно пройдена
$this->response->setData($result);
return $this->response;
```

## Проверка на роль "Администратор"
Чтобы проверить пользователя только на роль "Администратор" передайте такой массив проверок:
```php
$this->checker->run([
    'auth' => '',
    'role' => [],
]);

// Проверка успешно пройдена, в ином случае сработает исключение и будет автоматически выброшена соотвествующая ошибка в ответе сервера
```

## Проверка ролей
В месте вашего кода (обычно это в начале запуска контроллера) разместить следующий код:
```php
$this->checker->run([
    'auth' => '',
    'role' => [
        'page' => 'example',
        'access' => 'create-update',
    ],
]);

// Проверка успешно пройдена, в ином случае сработает исключение и будет автоматически выброшена соотвествующая ошибка в ответе сервера
```
Данная проверка посмотрит может ли данный пользователь добавлять и изменять записи `create-update` в разделе `example`

В самом начале проверяется роль администратора, если пользователь администратор, тогда сразу возвращается ответ об успешной проверке