<div id="container" style="height: 400px;"></div>

<script src="highcharts-gantt.js"></script>

<script>
    function versionRoadmap(roadmaps, options) {
        if (typeof (options) === 'undefined') {
            options = {};
        }

        /**
         * Simple object check.
         *
         * @author https://stackoverflow.com/a/34749873/6107711
         *
         * @param item
         *
         * @return {boolean}
         */
        function isObject(item) {
            return (item && typeof item === 'object' && !Array.isArray(item));
        }

        /**
         * Deep merge two objects.
         *
         * @author https://stackoverflow.com/a/34749873/6107711
         *
         * @param target
         * @param sources
         *
         * @return {Object}
         */
        function mergeDeep(target, ...sources) {
            if (!sources.length) {
                return target;
            }

            var source = sources.shift();

            if (isObject(target) && isObject(source)) {
                for (var key in source) {
                    if (source.hasOwnProperty(key)) {
                        if (isObject(source[key])) {
                            if (!target[key]) {
                                Object.assign(target, {[key]: {}});
                            }

                            mergeDeep(target[key], source[key]);
                        } else {
                            Object.assign(target, {[key]: source[key]});
                        }
                    }
                }
            }

            return mergeDeep(target, ...sources);
        }

        var settings = {
            containerID  : 'container',
            colors       : {
                outdated         : {
                    bg  : '#e03c31',
                    text: '#ffffff'
                },
                maintained       : {
                    bg  : '#6bb020',
                    text: '#ffffff'
                },
                securityFixesOnly: {
                    bg  : '#ffc734',
                    text: '#000000'
                },
                future           : {
                    bg  : '#eeeeee',
                    text: '#000000'
                },
                currentDayLine   : '#333333',
                xAxisGridLine    : '#cccccc',
                yAxisGridLine    : '#aaaaaa'
            },
            titles       : {
                chart            : 'My Project Roadmap',
                outdated         : 'Outdated',
                maintained       : 'Maintained',
                securityFixesOnly: 'Security fixes only',
                future           : 'Future release'
            },
            formatDate   : '%Y-%m-%d',
            formatTooltip: '<strong>{point.title}</strong><br/>From: {point.start:%Y-%m-%d}<br/>To: {point.end:%Y-%m-%d}',
            daysOverdue  : 90
        };

        settings = mergeDeep(settings, options);

        var now = new Date().getTime();

        var actualRoadmaps = roadmaps.filter(function (item) {
            var result = true;
            var diff   = now - new Date(item.dates[1].to).getTime();

            if (diff > 0) {
                var days = diff / 1000 / 60 / 60 / 24;

                if (days > settings.daysOverdue) {
                    result = false;
                }
            }

            return result;
        });

        var series = actualRoadmaps.map(function (roadmap, i) {
            var data = roadmap.dates.map(function (item, j) {
                var type = '!unknown!';

                switch (j) {
                    case 0:
                        type = 'maintained';
                        break;

                    case 1:
                        type = 'securityFixesOnly';
                        break;
                }

                return {
                    title: (settings.titles.hasOwnProperty(type) ? settings.titles[type] : '!unknown!'),
                    start: new Date(item.from).getTime(),
                    end  : new Date(item.to).getTime(),
                    color: (settings.colors.hasOwnProperty(type) ? settings.colors[type].bg : settings.colors.future.bg),
                    y    : i
                };
            });

            var roadmapColors = 'future';

            if (now >= new Date(roadmap.dates[0].from).getTime() && now <= new Date(roadmap.dates[0].to).getTime()) {
                roadmapColors = 'maintained';
            } else if (now >= new Date(roadmap.dates[1].from).getTime() && now <= new Date(roadmap.dates[1].to).getTime()) {
                roadmapColors = 'securityFixesOnly';
            } else if (now >= new Date(roadmap.dates[1].to).getTime()) {
                roadmapColors = 'outdated';
            }

            return {
                data  : data,
                name  : roadmap.version,
                colors: (settings.colors.hasOwnProperty(roadmapColors) ? settings.colors[roadmapColors] : settings.colors.future)
            };
        });

        var subtitlePointStyle = 'display: inline-block;width: 20px;border-radius: 3px;';
        var subtitle           =
                '<div style="background-color: ' + settings.colors.outdated.bg + ';' + subtitlePointStyle + '">&nbsp;</div> ' + settings.titles.outdated + '&nbsp;&nbsp;&nbsp;' +
                '<div style="background-color: ' + settings.colors.maintained.bg + ';' + subtitlePointStyle + '">&nbsp;</div> ' + settings.titles.maintained + '&nbsp;&nbsp;&nbsp;' +
                '<div style="background-color: ' + settings.colors.securityFixesOnly.bg + ';' + subtitlePointStyle + '">&nbsp;</div> ' + settings.titles.securityFixesOnly + '&nbsp;&nbsp;&nbsp;' +
                '<div style="background-color: ' + settings.colors.future.bg + ';' + subtitlePointStyle + '">&nbsp;</div> ' + settings.titles.future + '&nbsp;&nbsp;&nbsp;'
        ;

        Highcharts.ganttChart(settings.containerID, {
            series  : series,
            title   : {
                text: settings.titles.chart
            },
            subtitle: {
                text   : subtitle,
                align  : 'left',
                useHTML: true,
                x      : 70
            },
            tooltip : {
                pointFormat: settings.formatTooltip
            },
            xAxis   : [{
                tickInterval        : 365 * 24 * 3600 * 1000, // one year
                type                : 'category',
                lineColor           : 'transparent',
                tickColor           : settings.colors.yAxisGridLine,
                gridLineColor       : settings.colors.yAxisGridLine,
                gridLineWidth       : 1,
                labels              : {
                    style: {
                        fontWeight: 'bold'
                    }
                },
                currentDateIndicator: {
                    color    : settings.colors.currentDayLine,
                    dashStyle: 'dash',
                    width    : 1,
                    label    : {
                        format       : settings.formatDate,
                        align        : 'center',
                        verticalAlign: 'bottom',
                        y            : 15
                    }
                }
            }, {
                visible : false,
                opposite: false
            }],
            yAxis   : {
                type             : 'category',
                labels           : {
                    useHTML  : true,
                    formatter: function () {
                        var arr       = this.value.split('||');
                        var name      = arr[0];
                        var colorBg   = arr[1];
                        var colorText = arr[2];

                        return '<div style="background-color: ' + colorBg + ';color: ' + colorText + ';padding: 2px 6px;font-size: 13px;border-radius: 3px;">' + name + '</div>';
                    }
                },
                lineColor        : 'transparent',
                tickColor        : 'transparent',
                gridLineColor    : settings.colors.xAxisGridLine,
                gridLineDashStyle: 'longdash',
                grid             : {
                    columns: [{
                        categories: Highcharts.map(series, function (s) {
                            return s.name + '||' + s.colors.bg + '||' + s.colors.text;
                        })
                    }]
                }
            }
        });
    }

    var data = [
        {
            "version": "v1.4",
            "dates"  : [
                {
                    "from": "2019-04-22",
                    "to"  : "2019-05-15"
                }, {
                    "from": "2019-05-15",
                    "to"  : "2019-06-15"
                }
            ]
        }, {
            "version": "v1.5",
            "dates"  : [
                {
                    "from": "2019-05-15",
                    "to"  : "2019-06-06"
                }, {
                    "from": "2019-06-06",
                    "to"  : "2019-09-06"
                }
            ]
        }, {
            "version": "v1.6",
            "dates"  : [
                {
                    "from": "2019-06-06",
                    "to"  : "2019-07-27"
                }, {
                    "from": "2019-07-28",
                    "to"  : "2019-10-28"
                }
            ]
        }, {
            "version": "v1.7",
            "dates"  : [
                {
                    "from": "2019-07-28",
                    "to"  : "2022-07-27"
                }, {
                    "from": "2022-07-28",
                    "to"  : "2023-01-28"
                }
            ]
        }, {
            "version": "v1.8",
            "dates"  : [
                {
                    "from": "2020-02-01",
                    "to"  : "2020-07-31"
                }, {
                    "from": "2020-08-01",
                    "to"  : "2020-10-31"
                }
            ]
        }
    ];

    versionRoadmap(data, {
        titles       : {
            chart            : 'Lemurro Roadmap',
            outdated         : 'Устарел',
            maintained       : 'Поддерживается',
            securityFixesOnly: 'Только исправления безопасности',
            future           : 'Будущий релиз'
        },
        formatDate   : '%d.%m.%Y',
        formatTooltip: '<strong>{point.title}</strong><br/>Начало: {point.start:%d.%m.%Y}<br/>Конец: {point.end:%d.%m.%Y}'
    });
</script>